function SocialLinkWindow(tabbed_window,show_navbar,title,avatarid){var applink='http://mcms.fuihan.com/content/'+Ti.Utils.base64encode('&content='+Ti.App.Properties.getString('cloud_useremail','8.service@fuihan.com').substr(9,200))
var twitter_message='這是個很酷的 QRCode，你可以試試看 It is an amazing QRCode, Give it a try. '
var fb_message="我建立了一個 mCMS QR Code，跟別的QR Code不一樣，他包含了很多很酷的資訊喔"
var win=Ti.UI.createWindow({title:title,backgroundColor:'#fff',navBarHidden:true});var btn_fb=Ti.UI.createButton({title:'Share on Facebook',left:'10%',right:'10%',top:20})
btn_fb.addEventListener('click',function(e){var fb_post=require('ui/winmodule/fnc_fb_publish');var win_fb_post=new fb_post('GRAPH',fb_message)
var b=Ti.UI.createButton({title:'Close',style:Ti.UI.iPhone.SystemButtonStyle.PLAIN});win_fb_post.setLeftNavButton(b);b.addEventListener('click',function()
{win_fb_post.close();});win_fb_post.open({modal:true})})
win.add(btn_fb)
var btn_fb_dialog=Ti.UI.createButton({title:'Comment on Facebook',left:'10%',right:'10%',top:80})
btn_fb_dialog.addEventListener('click',function(e){var fb_post=require('ui/winmodule/fnc_fb_publish');var win_fb_post=new fb_post('DIALOG',fb_message)
var b=Ti.UI.createButton({title:'Close',style:Ti.UI.iPhone.SystemButtonStyle.PLAIN});win_fb_post.setLeftNavButton(b);b.addEventListener('click',function()
{win_fb_post.close();});win_fb_post.open({modal:true})})
win.add(btn_fb_dialog)
var btn_twitter_dialog=Ti.UI.createButton({title:'Twitter it',left:'10%',right:'10%',top:140})
btn_twitter_dialog.addEventListener('click',function(e){var accessTokenKey=Ti.App.Properties.getString('twitterAccessTokenKey'),accessTokenSecret=Ti.App.Properties.getString('twitterAccessTokenSecret');var twitter_consumerKey="oMxb6JZ0Ikh9eRJA13qNAw",twitter_consumerSecret="0XnpsqHqjU9WpRx1wTixFCV4VDrh9Rcd3Ix1ddFsHOc";var accessTokenKey=Ti.App.Properties.getString('twitterAccessTokenKey'),accessTokenSecret=Ti.App.Properties.getString('twitterAccessTokenSecret');var Twitter=require('ui/winmodule/lib_twitter/twitter').Twitter;var client=Twitter({consumerKey:twitter_consumerKey,consumerSecret:twitter_consumerSecret,accessTokenKey:accessTokenKey,accessTokenSecret:accessTokenSecret});client.addEventListener('login',function(e){if(e.success){Ti.App.Properties.setString('twitterAccessTokenKey',e.accessTokenKey);Ti.App.Properties.setString('twitterAccessTokenSecret',e.accessTokenSecret);client.request("1.1/statuses/update.json",{status:twitter_message+applink},'POST',function(e){if(e.success){alert('Successfully Tweetted')
Ti.API.info('Tweet msg:'+twitter_message+applink)}else{alert(e.error);}});}else{alert(e.error);}});client.authorize();})
win.add(btn_twitter_dialog)
var btn_weibo=Ti.UI.createButton({title:'Share on weibo',left:'10%',right:'10%',top:200})
btn_weibo.addEventListener('click',function(e){})
win.add(btn_weibo)
var btn_mail=Ti.UI.createButton({title:'Share via eMail',left:'10%',right:'10%',top:260})
btn_mail.addEventListener('click',function(e){var emailDialog=Ti.UI.createEmailDialog({html:true,subject:'QRCode Sharing',messageBody:'<html>這是個很酷的 QRCode，你可以試試看 It is an amazing QRCode, Give it a try.<br><h2><a href="'+applink+'"> mCMS QR</a></h2><br></html>'})
emailDialog.open();})
win.add(btn_mail)
win.addEventListener('open',function(){});if(tabbed_window&&show_navbar){win.navBarHidden=false;}else{win.navBarHidden=true;}
win.addEventListener('open',function(){logging('SOCIALLINK',title)})
return win};module.exports=SocialLinkWindow;